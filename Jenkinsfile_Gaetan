pipeline {
	agent any

	stages {
		stage('Better Readme') {
			steps {
				sh '''
					cat ./*.md >> ./Docker_Gaetan/manuel.md
				'''
			}
		}
		stage('Docker Login') {
			steps {
				sh 'echo eyJwYXlsb2FkIjoidG5QSGlFcDJWMGUzQVVrWjhHaFBiMmRnL2YrdlJJVGk0ajZFZmN2U0xwbVMyK1pZOUFrOE8xQUd6anlIaVJpb0JYQ0N0eHM2NjBleG50T2QxWjB6cTVmbExJRmNvb05Xbm82ckR0Vjc3Y3ExYTU0NFdRSkFiSWtvQUtyN0FTeVNrNGZYRC9rQjgvNlpRY2pDbkhuL3dNL05PRHkrbTJGbGYvVUxPc3p1VVRWL21GUlBrclJrdEdoTDFCOG9vdWdXVEtMaUhFaC8xeUNPd1d3T1NzVDJPbk14T1Q0TEVkdWFIZG51TC8vYnRkU0ZYbGRkOUxvTlNpN3pZZXpFdTBaZ1plSysvWjBnZlZjMHJ6MnRCV0MzdU1WS1RTYytUb21XbmQ2YW1OeVNHb085STBib0ZNYUhRK2Z5NzdnZGR0aGovV3Z6SmZGMUgyVWlxenN6R0Q0Z1JvNExKbVpnQUxoVTJBcXM4ZjFTSUdsVzMwa0ljYVRmd09iYXBMWTYwL1lIdnlCcDIvTEQrS01PZ1N5NncwU0w3QnhkTmFUNUQrRkF6VVcxaXdDa2VNSkRZRTZUS24rRWQ1MmVQMTliMExNYVZZTzl6eG1kT3h2M3NmVDRGaTVhTWhEaGJRL0Y1a0ZsQ2pwUmZURk1Na2ZhY0RoZld3KzZsVnVuRktSSWVEQm5GWDRzbEFLWkYyTy9JZi85RFNZUGJ5cjJsWjBiSms5ZTVnOEwrTkhBcEs1SUFGdlFpQUNQSHlGMG0rMzRObFhxb25mbmZzOU9OM1FmSzRFenZIOTJkMjRwbk96YkJIbUErTWg5T01YQ0ZLUjVQV2dQeEpjSXJaR2xrWDV2OUJhTTcwQkw5OVU0YUZZNjROYk1Pa3BBYjBkamt5UktEZkFFOFB1U2xOempsS2UyVUx3QjdKcmF0YlYwVnBuS2VrcU9aaVc0empNSSt5dWNUZnl6WTFmeVFRYU9IbkU2N21PdndTbzdpUzZBeE1vSm8yS2NQbFVKemdVMnJxUFZSSXZtWlg4N3BETG5vaSt5NlFXMUl3QllPM25wTmRsKzVmSk5ZLzJGUWpLZmlkaXJHMlhkR0NXMTJ5WmJGUGVxQ2dURGpEdTR0YjdzNjFBaTY3aXdkc1haM0xCOWM2OStOVG01NEtHbFVJanBuMGI4eGpSbmw2VlpEUmJWMHkzNStzQTlaaDFDMjgwZzB1Nk9Pd0JVRkdPVVlBNi82MnU4R2g1SEVOVjQ1YW5KMVpaLzZ5SVJldU1oVjREZGNhdEFuOE5DUzFrMlpScnZCOTNqekVkWU1obkU2dGNybVQ2cGh0ZC9BcmwzY2twWE45WTYyUm9raFdjYmtxQ2NBd055S0tsZitEM2xwNlV2c0xab3p6d0JuSnhIalNHNmthUDQ3NXFxeEJjcy91U3NXMzNiWjh5RWRZQ3hLOWRNYjVzYXZNeHlzNkprRDRON1hzck9zT3BiNzdrbWdua3YwMEtJbGUwbjY1REsvU3J5TDloTGlCMzZLczRwYUQwQjltZDVURXlPOTl1WTJEcEUzcUZ6ei9Md0ZBaXdiVVdlTGFoeDV5U1d4aWhIQW4rL2trbWJSbzByN3pRdlc4SXJQNXJYQWtoQmwrU3c4YzNON1NmOFZoR2ZmZG1mZXBVY0hrb2FhYVdPYTNzWFNNbDQzNHY0N0I3NTNkSVRqNDVvdEx1QTQrUUpTYktPNjROa0xMbDlBWGpTYXdEQlBhYnU5Z3ZDaHVCMTJOZzQ5L2FtdXRxeGNCc21oak9LRmIxcnRNbWRIcDcrZnR1bk91OEtKeGdMMTNrVzZtRHdLSTdJTFErT1A4ZVZmdzM1bldFR1UxTFo2VTd5UzhxMEd4VitSamNDdEhLeDVKVCtUcTNBaTFhVEF5bGt4c0VWakY4bEZmNWJicFpBZzFYbWd4eVhUTnRrcmlGa0c5N2ZrMUlrTjNpNWpIL0ZhdllsS2ZJc0dubERwbEY4aVVmY0ZPZThCK0xKOTlXMlVRaHgyNlpLVHZqeiIsImRhdGFrZXkiOiJBUUVCQUhod20wWWFJU0plUnRKbTVuMUc2dXFlZWtYdW9YWFBlNVVGY2U5UnE4LzE0d0FBQUg0d2ZBWUpLb1pJaHZjTkFRY0dvRzh3YlFJQkFEQm9CZ2txaGtpRzl3MEJCd0V3SGdZSllJWklBV1VEQkFFdU1CRUVER2hCcTBNSzZWak91RlExR1FJQkVJQTdhMTczTXNEQ3RxRDN2Mzg1TmJibERGd29ZWlpEc21abDh6bGVCK3RZZ2FmbFVRVjFwMkxucXg2d2UvNmxuTHNqQ3RNZW1RbDV5RDRNZVBnPSIsInZlcnNpb24iOiIyIiwidHlwZSI6IkRBVEFfS0VZIiwiZXhwaXJhdGlvbiI6MTcxMzU3NDk3OH0= | docker login --username AWS --password-stdin 536826959354.dkr.ecr.us-east-1.amazonaws.com'
			}
		}
		stage('Docker build and publish') {
			steps {
				dir('./Docker_Gaetan') {
					sh '''
						docker build -t epsi-alpine:latest .
						docker tag epsi-alpine:latest
						536826959354.dkr.ecr.us-east-1.amazonaws.com/epsi-alpine:latest
						docker push 536826959354.dkr.ecr.us-east-1.amazonaws.com/epsi-alpine:latest
					'''
				}
			}
		}
	}
}
